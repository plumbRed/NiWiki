[TOC]

## 1 基础配置(Requirement)

### 1.1 内联配置(Inline)

>A.所有数据源由设施上位机提供，无法提供提供的数据源不在此计划书范围内
>
>B.配套独立的设施MES服务器，并与设施上位机构建内部网

### 1.2 网络布局配置(Layout)

> A.将设施上位机和设施MES服务器并入一个网络(通过映射的方式)
>
> B.由IT判定方法，二选一：
>
> ​			将设施MES服务器连入办公网络，并打通与车间生产MES网络的通路(10.213.70.X)
>
> ​			或者将设施MES服务器连入车间生产MES网络，并打通与办公网络的通路（推荐）

![layout.drawio](.\image\layout.drawio.png)



## 2 需求分析(Demand)

### 2.1 需求概述(Summarize)

![required.png](.\image\required.png)

### 2.2 需求拆解(Analysis)

一、对接上位机软件提供商，确认数据对接方案

> 1. 对接实施上位机提供商，制定每一家上位机提供商的数据对接方案，并列出**所有**可以获得数据
> 2. 清点数据储存周期，预估数据量，确认**数据存储周期**
> 3. 从需求出发，定义每一个需求点，需要的数据值，汇总为清单（这里有个关键信息需要获取，除了基础的数据展示，是否有**其他需求**点，例如设置数值标准线等）
> 4. 将B中汇总的清单，按上位机提供商提供商分类，并协同上位机软件提供商确认清单中**每一个**点位的key-value值
> 5. 二次确认清点后的数据，对照查找，**是否有无法实现**的功能点

二、构建设施数据中心，同步数据

> 1. 构建**后台数据结构**，以适用承载和分析数据
> 2. 逐一对接上位机提供商，将数据**同步**至MES设施服务器，并进行ETL

三、完善查询报表平台，进行数据展示

> 1. 为数值类数据构建统一的前端展示框架，一般为**by时间的折线图**
> 2. 为布尔类数据构建统一的前端展示框架，一般为**by时间的发生次数统计表格**
> 3. 根据需求，拓展G、H需求的功能（前期C中需要确认还有哪些除展示**以外的功能点**）
> 4. 汇总展示图标，根据类型，**合并**同类型图标展示（例如：环保安全-废气，需要汇总所有排废气标准于一张图标上，具体看C中分析结果）
> 5. 按照HJK顺序依次完成环保安全、质量监控、能耗监控的所有图表

四、同步MES生产服务器数据，评估水电气能耗

> 1. 与MES生产服务器**同步设备的投入与产出**
> 2. 构建设备的投入与产出与水电气能耗的关系图，并分析基本的转化关系，**评估能源用量的状况**（即运算出一个标定值，表示同比能耗多了还是少了），此评估值由生产、设施经验提供

五、构建保养计划表单流程，推动设施自动化保养方案

> 1. **构建保养计划表单流程**，预期采用：选择保养项->依次确认保养流程的结果->可提前结束保养（即人为确认不需要保养）->保养完成

1. 后期选择保养项将改为自动化生成，采用定期生成和条件触发生成两种模式，具体**待续**

### 2.3 数据基础配套(Data Basic)

#### 2.3.1 基础数据模板(Agreed On A Draft)

- 数据平台：postgres DB

- 数据格式：

  ```json
  {
      "id":"1",
  	"code":"a.c.",
      "name":"三相交流电流",
      "value":"15",
      "unit":"安培",
      "collecttime":"2021-12-12 12:12:12",
      "createtime":"2021-12-12 12:12:13",
  }
  ```

- 数据更新周期：2min
- 数据同步周期：30sec

#### 2.3.2 废气上位机供应商数据

- 数据平台：S7
  - PLC1_CPU1500水系统192.168.0.20
  - PLC2_CPU1200工艺水192.168.0.30  
  - PLC3_CPU1500空调系统192.168.0.1
- 网络架构![系统架构](..\pic\废气构架.jpg)
- 数据点位 [](..\pic\废气PLC地址表.xls)

#### 2.3.3 电力上位机供应商数据

待定

#### 2.3.4 暖通上位机供应商数据

待定

### 2.4 数据流(DFD)

0层：```两种数据中心、四个功能点、三个主要系统```

![顶层DFD](.\image\DFD.drawio.png)



1层：

![DFD1.drawio](.\image\DFD1.drawio.png)



![DFD2.drawio](.\image\DFD2.drawio.png)



## 3 配套预计(Supporting Service)

### 3.1 硬件配套(Hardware)

| 硬件信息    | 材料规格              | 数量 | 单位 |
| ----------- | --------------------- | ---- | ---- |
| 八口路由器  | 待定                  | 1    | PCS  |
| Dell 服务器 | R740（XD,Linux）      | 1    | PCS  |
| 有线键盘    | 不限                  | 1    | PCS  |
| 有线鼠标    | 不限                  | 1    | PCS  |
| 显示器      | dell E2417H           | 1    | PCS  |
| 网线        | 待定                  |      |      |
| 电源插排    | 10A/250VAC，大于1000W | 1    | PCS  |

### 3.2 软件配套(SoftWare)

待定

### 3.3 人员配套(Staff)

前端工程师、后端工程师、需求分析师

## 4 原型设计(Design)

待定

